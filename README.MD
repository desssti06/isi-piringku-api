# ğŸ¥— API "Isi Piringku" â€“ Backend FastAPI

API ini digunakan untuk memprediksi komposisi makanan di atas piring menggunakan model segmentasi gambar **YOLOv8**. Hasil prediksi memberikan informasi proporsi makanan, evaluasi kecukupan, dan rekomendasi tambahan jika perlu.

---

## ğŸ“¦ Endpoint

### `POST /predict-isipiring`

**Deskripsi**:  
Menerima gambar (JPG/PNG) dan mengembalikan:

- Proporsi makanan (buah, sayur, lauk, makanan pokok)
- Evaluasi kecukupan berdasarkan standar "Isi Piringku"
- Rekomendasi tambahan (jika ada kekurangan)
- URL gambar hasil segmentasi

**Form Data**:
- `file`: File gambar (`image/jpeg`, `image/png`)

**Contoh Request (dengan `fetch`)**:
```javascript
const formData = new FormData();
formData.append("file", selectedImageFile); // dari input type="file"

const res = await fetch("http://localhost:8000/predict-isipiring", {
  method: "POST",
  body: formData,
});

const data = await res.json();
console.log(data);
```

**Contoh Respons**:
```json
{
  "proporsi": {
    "buah": 0.25,
    "lauk": 0.3,
    "makanan_pokok": 0.4,
    "sayur": 0.05
  },
  "evaluasi": {
    "lauk": "âœ… Cukup",
    "buah": "âŒ Kurang",
    "makanan_pokok": "âŒ Kurang",
    "sayur": "âŒ Kurang"
  },
  "rekomendasi": {
    "buah": "Tambahkan sekitar 1/12 bagian piring buah",
    "makanan_pokok": "Tambahkan sekitar 1/6 bagian piring makanan_pokok",
    "sayur": "Tambahkan sekitar 7/12 bagian piring sayur"
  },
  "image_url": "/result-image/5cf612dc..."
}
```

---

### `GET /result-image/{image_id}`

**Deskripsi**:  
Mengambil gambar hasil segmentasi dengan ID yang diperoleh dari `image_url` pada respons `POST /predict-isipiring`.

**Contoh**:
```http
GET http://localhost:8000/result-image/5cf612dc...
```

**Contoh penggunaan di frontend (React/Next.js)**:
```jsx
<img src={`http://localhost:8000/result-image/${imageId}`} alt="Hasil Segmentasi" />
```

---

## ğŸ“ Struktur Direktori

```
your_project/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ main.py  
â”‚   â””â”€â”€ yolov8_model.pt  
â”œâ”€â”€ model/
â”‚   â””â”€â”€ best.pt          # Model YOLOv8
â”œâ”€â”€ static/
â”‚   â””â”€â”€ results/         # Gambar hasil segmentasi disimpan di sini
â”œâ”€â”€ README.MD
â”œâ”€â”€ requirement.txt
```

---

## ğŸš€ Cara Menjalankan Backend

1. Install dependensi:
```bash
pip install fastapi uvicorn matplotlib ultralytics
```

2. Jalankan server:
```bash
uvicorn app.main:app --reload
```

3. Server akan tersedia di:
```
http://localhost:8000
```

---

## â„¹ï¸ Catatan Tambahan

- Semua respons evaluasi menggunakan icon (âœ… / âŒ) agar mudah dimengerti oleh pengguna.
- `image_url` bisa langsung digunakan sebagai `src` gambar.
- Gambar yang diunggah disegmentasi berdasarkan 5 kelas:
  - `buah`
  - `sayur`
  - `lauk`
  - `makanan_pokok`
  - `piring` (tidak dihitung dalam proporsi makanan)
